<br/>
<br/>
<div>
	<form id="frmrequisiciondet" action="{SET}" method="POST">
        <div class="item_requerid">Producto</div>
        <div class="form_requerid">
			<select name="COD_PROD" id="COD_PROD" class="chzn-select input-xxlarge">
					{lstproductos}
			</select>
		</div>
        <div class="item_requerid">Medida</div>
        <div class="form_requerid">
			<select name="CODIGO_UNIDAD" id="CODIGO_UNIDAD" class="chzn-select input-xlarge">
					{lstunimedida}
			</select>
		</div>
		<div class="item_requerid">Cantidad</div>
        <div class="form_requerid">
			<input type="text" name="CANTIDAD" id="CANTIDAD" class="input-mini">
		</div>
		<div class="item_requerid_textarea">Especificaciones</div>
        <div class="form_requerid">
			<textarea name="ESPECIFICACIONES" id="ESPECIFICACIONES" rows='2' cols='10' maxlength='500'></textarea>
		</div>
        <div class="form_button">
				<input type="submit" name="enviar" id="btn-savedet" value="Agregar" class='btn'>
				<input type="submit" name="btnfinalizar" id="btn-finalizar" value="Finalizar Requisicion" class='btn'>
		</div>
    </form>
</div> 
<div id="formulariox">
	
</div>
<script>
$("#btn-savedet").click(function(){
		$.ajax({
				url : 'index.php?ctl=controller_reqdet&' + $("#frmrequisiciondet").serialize() + '&' + $("#frmrequisicion").serialize() ,     
				data : { act : 'insert' },
				type : 'POST',     
				success : 
						function(resp) {
							$('#CANTIDAD').val('');
							$('#ESPECIFICACIONES').val('');
							$('#formulariox').fadeOut("slow").fadeIn("slow").html(resp);
						},
				error : 
						function(xhr, status) {
							alert('Disculpe, existió un problema');
						},     
				complete : function(xhr, status) {	
							
						}
	      	  	});
	     $('#btn-finalizar').removeAttr("disabled");
		return false;
});

$("#btn-finalizar").click(function(){
		$.ajax({
				url : 'index.php?ctl=controller_requisicion&' + $("#frmrequisiciondet").serialize() + '&' + $("#frmrequisicion").serialize() ,     
				data : { act : 'finalizar_req' },
				type : 'POST',     
				success : 
						function(resp) {
							$('#formulariox').fadeOut("slow").fadeIn("slow");
							$('#btn-savedet').attr("disabled", true);
						},
				error : 
						function(xhr, status) {
							alert('Disculpe, existió un problema');
						},     
				complete : function(xhr, status) {	
							
						}
	      	  	});
		return false;
});

</script>

